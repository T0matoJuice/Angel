# ğŸš€ æœåŠ¡å™¨éƒ¨ç½²æŒ‡å— - ä¸»é¡µæ”¹é€ 

## ğŸ“‹ éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶æ¸…å•

### 1ï¸âƒ£ æ–°å¢æ–‡ä»¶ï¼ˆéœ€è¦ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼‰

```
LLM_Detection_System/modules/common/dashboard_api.py
```

### 2ï¸âƒ£ ä¿®æ”¹æ–‡ä»¶ï¼ˆéœ€è¦æ›´æ–°ï¼‰

```
LLM_Detection_System/app.py
LLM_Detection_System/modules/common/routes.py
LLM_Detection_System/templates/mainPage.html
```

### 3ï¸âƒ£ é…ç½®æ–‡ä»¶ï¼ˆéœ€è¦æ ¹æ®æœåŠ¡å™¨ç¯å¢ƒä¿®æ”¹ï¼‰

```
LLM_Detection_System/.env
```

---

## ğŸ“ è¯¦ç»†ä¿®æ”¹è¯´æ˜

### æ–‡ä»¶1: `app.py`

**ä½ç½®**: `LLM_Detection_System/app.py`

**ä¿®æ”¹å†…å®¹**: åœ¨å¯¼å…¥éƒ¨åˆ†æ·»åŠ dashboard_apiè“å›¾

**ç¬¬34è¡Œé™„è¿‘**ï¼Œæ·»åŠ ï¼š
```python
from modules.common.dashboard_api import dashboard_api_bp
```

**ç¬¬64è¡Œé™„è¿‘**ï¼Œæ·»åŠ ï¼š
```python
app.register_blueprint(dashboard_api_bp)  # ä»ªè¡¨ç›˜API
```

**å®Œæ•´çš„å¯¼å…¥éƒ¨åˆ†åº”è¯¥æ˜¯**ï¼š
```python
from flask import Flask
from flask_cors import CORS
from modules.common.config import init_app_config
from modules.auth import init_auth
from modules.auth.routes import auth_bp
from modules.auth.oauth_routes import oauth_bp
from modules.drawing.routes import drawing_bp
from modules.excel.routes import excel_bp
from modules.common.routes import common_bp
from modules.common.dashboard_api import dashboard_api_bp  # â† æ–°å¢è¿™è¡Œ
from modules.api.drawing_api import drawing_api_bp
from modules.api.excel_api import excel_api_bp
```

**å®Œæ•´çš„è“å›¾æ³¨å†Œéƒ¨åˆ†åº”è¯¥æ˜¯**ï¼š
```python
# æ³¨å†Œè“å›¾ - APIæ¥å£
app.register_blueprint(oauth_bp, url_prefix='/api/oauth')
app.register_blueprint(dashboard_api_bp)  # â† æ–°å¢è¿™è¡Œ
app.register_blueprint(drawing_api_bp, url_prefix='/api/v1/drawing')
app.register_blueprint(excel_api_bp, url_prefix='/api/v1/excel')
```

---

### æ–‡ä»¶2: `modules/common/routes.py`

**ä½ç½®**: `LLM_Detection_System/modules/common/routes.py`

**ä¿®æ”¹å†…å®¹**: å°†æ–°ä¸»é¡µè®¾ä¸ºé»˜è®¤ä¸»é¡µï¼Œå¹¶æ·»åŠ ç™»å½•éªŒè¯

**æ›¿æ¢æ•´ä¸ªæ–‡ä»¶å†…å®¹ä¸º**ï¼š
```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
å…¬å…±è·¯ç”±æ¨¡å—
"""

from flask import Blueprint, render_template, jsonify
from flask_login import login_required  # â† é‡è¦ï¼šæ·»åŠ è¿™è¡Œ

# åˆ›å»ºå…¬å…±è·¯ç”±è“å›¾
common_bp = Blueprint('common', __name__)

@common_bp.route('/')
@login_required  # â† é‡è¦ï¼šæ·»åŠ è¿™è¡Œï¼Œç¡®ä¿ç”¨æˆ·ç™»å½•åæ‰èƒ½è®¿é—®
def index():
    """é›†æˆç³»ç»Ÿä¸»é¡µ - æ–°ç‰ˆä»ªè¡¨ç›˜ï¼ˆå¸¦ç»Ÿè®¡æ•°æ®ï¼‰"""
    return render_template('mainPage.html')

@common_bp.route('/old')
@login_required  # â† é‡è¦ï¼šæ·»åŠ è¿™è¡Œ
def old_index():
    """æ—§ç‰ˆä¸»é¡µ - ç®€å•å…¥å£é¡µé¢ï¼ˆå¤‡ä»½ï¼‰"""
    return render_template('index.html')

@common_bp.route('/health')
def health():
    """å¥åº·æ£€æŸ¥"""
    return jsonify({'status': 'ok', 'message': 'å¤§æ¨¡å‹æ™ºèƒ½æ£€æµ‹ç³»ç»Ÿè¿è¡Œæ­£å¸¸'})
```

**âš ï¸ é‡è¦è¯´æ˜**ï¼š
- æ·»åŠ äº† `@login_required` è£…é¥°å™¨ï¼Œç¡®ä¿ç”¨æˆ·ç™»å½•åæ‰èƒ½è®¿é—®ä¸»é¡µ
- è¿™æ ·å¯ä»¥æ­£ç¡®æ˜¾ç¤ºç™»å½•ç”¨æˆ·çš„ç”¨æˆ·åï¼Œè€Œä¸æ˜¯"è®¿å®¢"

---

### æ–‡ä»¶3: `modules/common/dashboard_api.py`

**ä½ç½®**: `LLM_Detection_System/modules/common/dashboard_api.py`

**æ“ä½œ**: è¿™æ˜¯æ–°æ–‡ä»¶ï¼Œç›´æ¥ä¸Šä¼ æ•´ä¸ªæ–‡ä»¶åˆ°æœåŠ¡å™¨

**æ–‡ä»¶å†…å®¹**: è§æœ¬åœ°æ–‡ä»¶ `d:\work\angel_official\LLM_Detect_master\LLM_Detect_master\LLM_Detection_System\modules\common\dashboard_api.py`

---

### æ–‡ä»¶4: `templates/mainPage.html`

**ä½ç½®**: `LLM_Detection_System/templates/mainPage.html`

**æ“ä½œ**: ç”¨æœ¬åœ°çš„æ–°ç‰ˆæœ¬æ›¿æ¢æœåŠ¡å™¨ä¸Šçš„æ—§ç‰ˆæœ¬

**æ–‡ä»¶å†…å®¹**: è§æœ¬åœ°æ–‡ä»¶ `d:\work\angel_official\LLM_Detect_master\LLM_Detect_master\LLM_Detection_System\templates\mainPage.html`

---

### æ–‡ä»¶5: `.env`

**ä½ç½®**: `LLM_Detection_System/.env`

**âš ï¸ é‡è¦**: è¿™ä¸ªæ–‡ä»¶éœ€è¦æ ¹æ®æœåŠ¡å™¨ç¯å¢ƒä¿®æ”¹ï¼

**æœ¬åœ°é…ç½®**ï¼ˆä»…ä¾›å‚è€ƒï¼Œä¸è¦ç›´æ¥å¤åˆ¶åˆ°æœåŠ¡å™¨ï¼‰ï¼š
```env
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=123456
DB_NAME=angel
```

**æœåŠ¡å™¨é…ç½®**ï¼ˆéœ€è¦ä½ æ ¹æ®å®é™…æƒ…å†µå¡«å†™ï¼‰ï¼š
```env
DB_HOST=10.2.32.162  # æˆ–æœåŠ¡å™¨å®é™…çš„æ•°æ®åº“åœ°å€
DB_PORT=3306
DB_USER=root
DB_PASSWORD=Angel#20251204  # æœåŠ¡å™¨å®é™…çš„æ•°æ®åº“å¯†ç 
DB_NAME=angel
```

---

## ğŸ”§ éƒ¨ç½²æ­¥éª¤

### æ­¥éª¤1: å¤‡ä»½æœåŠ¡å™¨æ–‡ä»¶

åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼š
```bash
cd /path/to/LLM_Detection_System
cp app.py app.py.backup
cp modules/common/routes.py modules/common/routes.py.backup
cp templates/mainPage.html templates/mainPage.html.backup
```

### æ­¥éª¤2: ä¸Šä¼ æ–°æ–‡ä»¶

ä¸Šä¼ ä»¥ä¸‹æ–‡ä»¶åˆ°æœåŠ¡å™¨ï¼š
1. `modules/common/dashboard_api.py` ï¼ˆæ–°æ–‡ä»¶ï¼‰
2. `app.py` ï¼ˆä¿®æ”¹åï¼‰
3. `modules/common/routes.py` ï¼ˆä¿®æ”¹åï¼‰
4. `templates/mainPage.html` ï¼ˆä¿®æ”¹åï¼‰

### æ­¥éª¤3: æ£€æŸ¥.envé…ç½®

ç¡®ä¿æœåŠ¡å™¨çš„ `.env` æ–‡ä»¶ä¸­æ•°æ®åº“é…ç½®æ­£ç¡®ï¼š
```bash
cat .env | grep DB_
```

åº”è¯¥çœ‹åˆ°ï¼š
```
DB_HOST=10.2.32.162  # æˆ–å®é™…åœ°å€
DB_PORT=3306
DB_USER=root
DB_PASSWORD=Angel#20251204  # æˆ–å®é™…å¯†ç 
DB_NAME=angel
```

### æ­¥éª¤4: é‡å¯åº”ç”¨

```bash
# å¦‚æœä½¿ç”¨systemd
sudo systemctl restart llm-detection

# æˆ–è€…å¦‚æœç›´æ¥è¿è¡Œ
pkill -f "python.*app.py"
python app.py
```

### æ­¥éª¤5: éªŒè¯

è®¿é—®æœåŠ¡å™¨åœ°å€ï¼Œä¾‹å¦‚ï¼š
```
http://æœåŠ¡å™¨IP:5000/
```

åº”è¯¥èƒ½çœ‹åˆ°æ–°çš„ä¸»é¡µï¼Œæ˜¾ç¤ºçœŸå®çš„ç»Ÿè®¡æ•°æ®ã€‚

---

## âœ… éªŒè¯æ¸…å•

éƒ¨ç½²åæ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š

- [ ] è®¿é—® `/` æ˜¾ç¤ºæ–°ä¸»é¡µï¼ˆå¸¦ç»Ÿè®¡æ•°æ®ï¼‰
- [ ] è®¿é—® `/old` æ˜¾ç¤ºæ—§ä¸»é¡µï¼ˆå¤‡ä»½ï¼‰
- [ ] ç»Ÿè®¡æ•°æ®æ­£ç¡®æ˜¾ç¤ºï¼ˆä¸æ˜¯0ï¼‰
- [ ] æœ€è¿‘è®°å½•æ­£ç¡®æ˜¾ç¤º
- [ ] ç”¨æˆ·åæ­£ç¡®æ˜¾ç¤º
- [ ] ç‚¹å‡»å¡ç‰‡èƒ½æ­£ç¡®è·³è½¬
- [ ] æ— JavaScripté”™è¯¯ï¼ˆF12æŸ¥çœ‹æ§åˆ¶å°ï¼‰

---

## ğŸ”„ å›æ»šæ–¹æ¡ˆ

å¦‚æœéƒ¨ç½²åæœ‰é—®é¢˜ï¼Œæ‰§è¡Œï¼š

```bash
cd /path/to/LLM_Detection_System
cp app.py.backup app.py
cp modules/common/routes.py.backup modules/common/routes.py
cp templates/mainPage.html.backup templates/mainPage.html
rm modules/common/dashboard_api.py
# é‡å¯åº”ç”¨
```

---

## ğŸ“Š æ ¸å¿ƒæ”¹åŠ¨æ€»ç»“

### æ–°å¢åŠŸèƒ½
1. âœ… 3ä¸ªAPIæ¥å£ï¼ˆç»Ÿè®¡æ•°æ®ã€æœ€è¿‘è®°å½•ã€ç”¨æˆ·ä¿¡æ¯ï¼‰
2. âœ… åŠ¨æ€æ•°æ®å±•ç¤ºï¼ˆæ›¿ä»£é™æ€æ•°æ®ï¼‰
3. âœ… è‡ªåŠ¨åˆ·æ–°ï¼ˆæ¯30ç§’ï¼‰
4. âœ… é”™è¯¯å®¹é”™ï¼ˆæ•°æ®åº“å¤±è´¥ä¹Ÿèƒ½æ˜¾ç¤ºï¼‰

### è·¯ç”±å˜åŒ–
- `/` - æ–°ä¸»é¡µï¼ˆmainPage.htmlï¼‰â† æ”¹å˜
- `/old` - æ—§ä¸»é¡µï¼ˆindex.htmlï¼‰â† æ–°å¢
- `/main` - å·²åˆ é™¤
- `/api-test` - å·²åˆ é™¤

### æ•°æ®åº“ä¾èµ–
- éœ€è¦è®¿é—® `drawing_data` è¡¨
- éœ€è¦è®¿é—® `workorder_data` è¡¨
- éœ€è¦è®¿é—® `user` è¡¨ï¼ˆç”¨æˆ·è®¤è¯ï¼‰

---

## ğŸ†˜ å¸¸è§é—®é¢˜

### Q1: é¡µé¢æ˜¾ç¤º"åŠ è½½ä¸­..."ä¸æ¶ˆå¤±
**A**: æ£€æŸ¥æ•°æ®åº“è¿æ¥é…ç½®ï¼ŒæŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯

### Q2: ç»Ÿè®¡æ•°æ®æ˜¾ç¤º0
**A**: æ•°æ®åº“ä¸­å¯èƒ½æ²¡æœ‰æ•°æ®ï¼Œæˆ–è€…æŸ¥è¯¢å¤±è´¥ï¼ˆæŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—ï¼‰

### Q3: APIè¿”å›500é”™è¯¯
**A**: æ£€æŸ¥ `dashboard_api.py` æ˜¯å¦æ­£ç¡®ä¸Šä¼ ï¼Œæ£€æŸ¥æ•°æ®åº“è¿æ¥

### Q4: é¡µé¢404é”™è¯¯
**A**: æ£€æŸ¥ `routes.py` æ˜¯å¦æ­£ç¡®ä¿®æ”¹ï¼Œæ£€æŸ¥åº”ç”¨æ˜¯å¦é‡å¯

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œæ£€æŸ¥ï¼š
1. æœåŠ¡å™¨æ—¥å¿—ï¼šæŸ¥çœ‹Pythonåº”ç”¨è¾“å‡º
2. æµè§ˆå™¨æ§åˆ¶å°ï¼šF12æŸ¥çœ‹JavaScripté”™è¯¯
3. ç½‘ç»œè¯·æ±‚ï¼šF12 Networkæ ‡ç­¾æŸ¥çœ‹APIè¯·æ±‚

---

**éƒ¨ç½²å®Œæˆåï¼Œè®¿é—®æœåŠ¡å™¨åœ°å€å³å¯çœ‹åˆ°æ–°ä¸»é¡µï¼** ğŸ‰
